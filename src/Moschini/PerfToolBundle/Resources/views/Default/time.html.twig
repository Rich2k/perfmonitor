{% extends "MoschiniPerfToolBundle::layout.html.twig" %}
{% block title 'Time' %}

{% block javascripts %}
<script src="{{ asset('js/d3.v3.min.js') }}"></script>
<script src="{{ asset('js/time-graph.js') }}"></script>
<script type="text/javascript">
{% for url, times in values %}
    var avgs = [];
    
    datas = {{ times|json_encode|raw }};
    for(time in datas)
    {
        avgs.push({'date': new Date(parseInt(time)*1000), 'value': getHistAvgValue(datas[time])});
    }
    showTimesGraph(avgs, '#div-key-{{ loop.index }}', {{ from.getTimestamp*1000 }}, {{ to.getTimestamp*1000 }});
{% endfor %}
</script>

{% include 'MoschiniPerfToolBundle::menu.html.twig' with {'site': app.request.get('site'), 'route': 'moschini_perftool_default_time'} %}
{% render url('moschini_perftool_sites_js', {'site': app.request.get('site'), 'url': app.request.get('url')}) %}
{% endblock %}

{% block content %}

{% render url('moschini_perftool_sites_sites', {'site': app.request.get('site')}) %}

{% for url, times in values %}
<div id="div-key-{{ loop.index }}">
<h3><a href="{{ path('moschini_perftool_default_graph', {'site': app.request.get('site'), 'url': url}) }}">{{ url }}</a></h3>
</div>
{% endfor %}

{% endblock %}
