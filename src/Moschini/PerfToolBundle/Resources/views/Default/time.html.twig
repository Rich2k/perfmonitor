{% extends "MoschiniPerfToolBundle::layout.html.twig" %}
{% block title 'Time' %}

{% block javascripts %}
<script src="{{ asset('js/d3.v3.min.js') }}"></script>
<script src="{{ asset('js/time-graph.js') }}"></script>
<script type="text/javascript">
var values={};

{% for har in files %}
    {% for id, page in har.getPages %}
    if(!values['{{ page.getUrl }}'])
        values['{{ page.getUrl }}'] = [];

    values['{{ page.getUrl }}'].push({{ page.getLoadTimeAndDate|json_encode|raw }});

    {% endfor %}
{% endfor %}
    

for(page in values)
{
    var avgs = [];
    
    datas = groupValuesByDate(values[page]);
    for(time in datas)
    {
        avgs.push({'date': parseInt(time), 'value': getHistAvgValue(datas[time])});
        console.log(parseInt(time), getHistAvgValue(datas[time]));
    }
	
    showTimesGraph(avgs, page);
}

    $(function(){
        $('#menu-nav a[href="{{ path('moschini_perftool_default_time') }}"]').parent().addClass('active');
    });
</script>
{% endblock %}

{% block content %}

{% if sites is defined %}
<ul>
{% for site in sites %}
<li><a href="{{ path('moschini_perftool_default_time', {'site': site}) }}">{{ site }}</a></li>
{% endfor %}
</ul>
{% endif %}

{% endblock %}
